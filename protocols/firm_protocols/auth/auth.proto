syntax = "proto3";
package firm_protocols.auth;

service Authentication {
  rpc AcquireToken (AcquireTokenParameters) returns (Token);
  rpc Authenticate (AuthenticationParameters) returns (Empty);
}

message AcquireTokenParameters {
  string scope = 1;
}

message Token {
  string token = 1;
  uint64 expires_at = 2;
  string scope = 3;
}

message AuthenticationParameters {
  string expected_audience = 1;
  string token = 2;
}

message Empty {}
